hostname R3

no ip domain-lookup

! ---------------------------------------------------------
! IPv4 and IPv6 addressing and routing
! ---------------------------------------------------------

int g0/0/0
    ip add 10.2.2.1 255.255.255.252
    ipv6 address 2001:DB8:ACAD:2::1/64
    no shut

int g0/0/1
    ip add 192.168.3.1 255.255.255.0
    ipv6 address 2001:DB8:ACAD:C::1/64
    no shut

router ospf 1
    network 10.2.2.0 0.0.0.3 area 0
    network 192.168.3.0 0.0.0.255 area 0
    passive-interface g0/0/1
    exit

! ---------------------------------------------------------
! Static routes for IPv6
! ---------------------------------------------------------

ipv6 route 2001:DB8:ACAD:1::/64 2001:DB8:ACAD:2::2
ipv6 route 2001:DB8:ACAD:A::/64 2001:DB8:ACAD:2::2

! ---------------------------------------------------------
! VERIFY CONFIGURATION:
! show ip ospf neighbor
! show ip route
! show ipv6 route
! ---------------------------------------------------------

! ---------------------------------------------------------
! ACL to restrict traffic from LAN to only specific traffic
! ---------------------------------------------------------

ip access-list extended FILTER-TRAFFIC
    remark Permit ICMP from PC-C
    permit icmp host 192.168.3.3 any
    remark Permit HTTP and HTTPS from LAN
    permit tcp 192.168.3.0 0.0.0.255 any eq 80
    permit tcp 192.168.3.0 0.0.0.255 any eq 443
    remark Permit OSPF traffic
    permit ospf any any
    remark Deny all other traffic
    deny ip any any log
    exit

interface g0/0/1
    ip access-group FILTER-TRAFFIC in
    exit

! ---------------------------------------------------------
! VERIFY CONFIGURATION:
! show ip access-lists FILTER-TRAFFIC
! show ip interface g0/0/1
! ---------------------------------------------------------

! ---------------------------------------------------------
! SSH configuration
! ---------------------------------------------------------

ip domain-name ccnasecurity.com

crypto key generate rsa general-keys modulus 2048

username admin privilege 15 secret Cisco12345

ip ssh version 2
ip ssh time-out 90
ip ssh authentication-retries 2

ip access-list standard SSH-ACCESS
    remark Permit SSH from local LAN only
    permit 192.168.3.0 0.0.0.255
    deny any log
    exit

line vty 0 4
    transport input ssh
    login local
    access-class SSH-ACCESS in
    exit

! ---------------------------------------------------------
! VERIFY CONFIGURATION:
! show ip ssh
! show access-lists
! show ipv6 access-lists
! show ip access-lists FILTER-TRAFFIC
! ---------------------------------------------------------